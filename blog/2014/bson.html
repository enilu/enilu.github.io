<!DOCTYPE html>
<!--[if IE 8]>
<html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]>
<html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en"> <!--<![endif]-->
<!-- BEGIN HEAD -->
<head>
    <meta charset="utf-8"/>
    <title>enilu的技术博客 | 5分钟看懂BSON协议 </title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <meta content="技术博客,enilu的技术博客,bson" name="description"/>
    <meta content="enilu的技术博客，欢迎批评指正,5分钟看懂BSON协议" name="description">
    <meta content="enilu" name="author"/>

    <!-- BEGIN GLOBAL MANDATORY STYLES -->
    <link href="../../assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="../../assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <!-- END GLOBAL MANDATORY STYLES -->

    <!-- BEGIN PAGE LEVEL PLUGIN STYLES -->
    <link href="../../assets/plugins/fancybox/source/jquery.fancybox.css" rel="stylesheet"/>
    <!-- END PAGE LEVEL PLUGIN STYLES -->

    <!-- BEGIN THEME STYLES -->
    <link href="../../assets/css/style-metronic.css" rel="stylesheet" type="text/css"/>
    <link href="../../assets/css/style.css" rel="stylesheet" type="text/css"/>
    <link href="../../assets/css/themes/blue.css" rel="stylesheet" type="text/css" id="style_color"/>
    <link href="../../assets/css/style-responsive.css" rel="stylesheet" type="text/css"/>
    <link href="../../assets/css/custom.css" rel="stylesheet" type="text/css"/>
    <!-- END THEME STYLES -->

    <link rel="shortcut icon" href="favicon.ico"/>
</head>
<!-- END HEAD -->

<!-- BEGIN BODY -->
<body>
<!-- BEGIN STYLE CUSTOMIZER -->
<div class="color-panel hidden-sm">
    <div class="color-mode-icons icon-color"></div>
    <div class="color-mode-icons icon-color-close"></div>
    <div class="color-mode">
        <p>THEME COLOR</p>
        <ul class="inline">
            <li class="color-blue current color-default" data-style="blue"></li>
            <li class="color-red" data-style="red"></li>
            <li class="color-green" data-style="green"></li>
            <li class="color-orange" data-style="orange"></li>
        </ul>
        <label>
            <span>Header</span>
            <select class="header-option form-control input-small">
                <option value="default" selected>Default</option>
                <option value="fixed">Fixed</option>
            </select>
        </label>
    </div>
</div>
<!-- END BEGIN STYLE CUSTOMIZER -->

<!-- BEGIN HEADER -->
<div class="header navbar navbar-default navbar-static-top">
    <div class="container">
        <div class="navbar-header">
            <!-- BEGIN RESPONSIVE MENU TOGGLER -->
            <button class="navbar-toggle btn navbar-btn" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!-- END RESPONSIVE MENU TOGGLER -->
            <!-- BEGIN LOGO (you can use logo image instead of text)-->
            <a class="navbar-brand logo-v1" href="index.html">
                <img src="../../assets/img/logo_blue.png" id="logoimg" alt="" style="width:200px;height:60px">
            </a>
            <!-- END LOGO -->
        </div>

        <!-- BEGIN TOP NAVIGATION MENU -->
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li><a href="../../index.html" target="_blank">首页</a></li>
                <li class="active"><a href="../../index.html">博客</a></li>
                <li><a href="../2015/hot_article.html">精选转载</a></li>
                <li><a href="#">举个栗子</a></li>

                <li class="menu-search">
                    <span class="sep"></span>
                    <i class="fa fa-search search-btn"></i>

                    <div class="search-box">
                        <form action="#">
                            <div class="input-group input-large">
                                <input class="form-control" type="text" placeholder="Search">
                                    <span class="input-group-btn">
                                        <button type="submit" class="btn theme-btn">Go</button>
                                    </span>
                            </div>
                        </form>
                    </div>
                </li>
            </ul>
        </div>
        <!-- BEGIN TOP NAVIGATION MENU -->
    </div>
</div>
<!-- END HEADER -->

<!-- BEGIN PAGE CONTAINER -->
<div class="page-container">

    <!-- BEGIN BREADCRUMBS -->
    <div class="row breadcrumbs margin-bottom-40">
        <div class="container">
            <div class="col-md-4 col-sm-4">
                <h1>5分钟看懂BSON协议</h1>
            </div>
            <div class="col-md-8 col-sm-8">
                <ul class="pull-right breadcrumb">
                    <li><a href="../../index.html">首页</a></li>
                    <li><a href="../../index.html">博客</a></li>
                    <li class="active">文章详情</li>

                </ul>
            </div>
        </div>
    </div>
    <!-- END BREADCRUMBS -->

    <!-- BEGIN CONTAINER -->
    <div class="container min-hight">
        <!-- BEGIN BLOG -->
        <div class="row">
            <!-- BEGIN LEFT SIDEBAR -->
            <div class="col-md-9 blog-item margin-bottom-40">
                <p>

                <div class="pcs-article-content_ptkaiapt4bxy_baiduscarticle"
                     id="detailArticleContent_ptkaiapt4bxy_baiduscarticle"><p style="text-align: center;">

                    <p style="color: #3e3e3e; background-color: #ffffff; line-height: 25px;">
                        NOSQL从10年开始已经发展了4年了。其中最火的Mongodb也被人熟知，不过自己一直没有机会了解下这方面东东，最近有时间稍微看了下Mongodb的bson协议，在同事的指导下，整理出来分享给大家。至于BSON的概念我就不赘述了，自己找度娘。</p>

                    <p style="color: #3e3e3e; background-color: #ffffff; line-height: 25px;">下面是用java写的将数据生成BSON二进制的伪代码：<br>
<pre>
<code>
map = new map();
map.put("data","{id:'1',name:'张三'}");
BSONObject &nbsp;bson =parse(map);
byte[] bsonBytes = bson.toByte();
    生成结果为：<br>
bsonBytes = { 52, 0, 0, 0, 5, 100, 97, 116, 97, 0, 36, 0, 0, 0, 0,123,
0, 105, 0, 100, 0, 58, 0, 39, 0, 49, 0, 39, 0, 44, 0, 110,0, 97, 0, 109,
0, 101, 0,58, 0, 39, 0, 32, 95, 9, 78, 39, 0,125, 0, 0 };<br>
    为了后面说明方便，先将bsonBytes进行简单的格式化：<br>
bsonBytes = { <br> 52, 0, 0, 0, <br> 5, <br> 100, 97, 116, 97, <br> 0, <br> 36, 0, 0, 0, <br> 0,<br>
123, 0, 105, 0, 100, 0, 58, 0, 39, 0, 49, 0, 39, 0, 44, 0, 110,0, 97,
0, 109, 0, 101, 0,58, 0, 39, 0, 32, 95, 9, 78, 39, 0,125, 0, <br> 0 <br> };
</code>
</pre>
<br>

                    <p style="color: #3e3e3e; background-color: #ffffff; line-height: 25px;">
                        打开BSON协议页面：http://bsonspec.org/spec.html，根据该页面将bsonBytes为生成的二进制注释。</p>

                    <p style="color: #3e3e3e; background-color: #ffffff; line-height: 25px;">bsonBytes = { <br> 52, 0,
                        0, 0, &nbsp;<span style="color: red;">【</span><span style=""> <span
                                style="color: blue;">in</span><span style="color: blue;">t32</span> is the total number of bytes comprising the document 52表示文档的总长度</span><span
                                style="color: red;">】</span><br> 5, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; <span style="color: red;">【</span><span style="color: red;"><span
                                style="color: blue;">"\x05"</span> e_name binary</span><span style=""> </span><span
                                style="color: red;">Binary data，5表示表示e_name的类型是二进制的</span><span
                                style="color: red;">】</span><br> 100, 97, 116, 97, <span style="color: red;">【:e_name:cstring </span><span
                                style="font-family: monospace; color: red;"><span style="color: blue;">byte*</span>) "\x00",这里表示ename的主体</span><span
                                style="color: red;">】(字符串形式为：data)</span><br> 0, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: red;">【:e_name:cstring</span><span
                                style="color: red;"> </span><span style="font-family: monospace;"><span
                                style="color: red;">byte*</span><span style="color: red;">)</span></span><span
                                style="font-family: monospace; color: red;"> <span style="color: blue;">"\x00"</span>,ename以0结尾</span><span
                                style="color: red;">】</span><br> 36, 0, 0, 0, <span style="color: red;">【</span><span
                                style="font-family: monospace; color: red;"><span style="color: blue;">int32</span> subtype (byte*)element主体 int32即36表示消息主体的长度</span><span
                                style="color: red;">】</span><br> 0, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        &nbsp;<span style="color: red;">【</span><span style="font-family: monospace;">int32</span><span
                                style="font-family: monospace; color: red;"> <span style="color: blue;">subtype</span> (byte*)element主体 subtype 即0表示消息主体的类型微二进制：subtype<span
                                style=""> </span>::=<span style=""> </span>"\x00"<span style=""> </span>Generic binary subtype</span><span
                                style="color: red;">】</span><br>
                        123, 0, 105, 0, 100, 0, 58, 0, 39, 0, 49, 0, 39, 0, 44, 0, 110,0, 97,
                        0, 109, 0, 101, 0,58, 0, 39, 0, 32, 95, 9, 78, 39, 0,125, 0, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                        <span style="color: red;">【消息主体的二进制数据</span><span style="color: red;">】(字符串形式为：{id:'1',name:'张三'})</span><br>
                        0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span
                                style="color: red;"> &nbsp; &nbsp; 【</span><span
                                style="color: red;">document</span><span style=""> </span><span
                                style="color: red;">::=</span><span style=""> </span><span style="color: red;">int32 e_list <span
                                style="color: blue;">"\x00"</span> 文档主体以0结尾</span><span style="color: red;">】</span><br>
                    </p>

                    <p style="color: #3e3e3e; background-color: #ffffff; line-height: 25px;">};</p>

                    <p style="color: #3e3e3e; background-color: #ffffff; line-height: 25px;">over！！！o(∩∩)o...</p>


                    <p><br></p></div>
                </p>

                <ul class="blog-info">
                    <li><i class="fa fa-user"></i> By enilu</li>
                    <li><i class="fa fa-calendar"></i> 28/07/2014</li>
                    <li><i class="fa fa-comments"></i> 0</li>
                    <li><i class="fa fa-tags"></i> bson,大数据</li>
                </ul>


                <div class="post-comment">

                    <form role="form">

                        <p><a class="btn btn-default theme-btn" href="mailto:eniluzt@qq.com">联系我</a></p>
                    </form>
                </div>
            </div>
            <!-- END LEFT SIDEBAR -->

            <!-- BEGIN RIGHT SIDEBAR -->
            <div class="col-md-3 blog-sidebar">
                <!-- CATEGORIES START -->
                <h2>分类</h2>
                <ul class="nav sidebar-categories margin-bottom-40">

                </ul>
                <!-- CATEGORIES END -->

                <!-- BEGIN RECENT NEWS -->
                <h2>热门文章</h2>

                <div class="recent-news margin-bottom-10">
                    <div class="row margin-bottom-10">

                        <div class="col-md-12 recent-news-inner">
                            <h3><a href="#">Letiusto gnissimos</a></h3>

                            <p>Decusamus tiusto odiodig nis simos ducimus qui sint</p>
                        </div>
                    </div>
                    <div class="row margin-bottom-10">

                        <div class="col-md-12 recent-news-inner">
                            <h3><a href="#">Letiusto gnissimos</a></h3>

                            <p>Decusamus tiusto odiodig nis simos ducimus qui sint</p>
                        </div>
                    </div>
                    <div class="row margin-bottom-10">

                        <div class="col-md-12 recent-news-inner">
                            <h3><a href="#"></a></h3>

                            <p></p>
                        </div>
                    </div>
                    <div class="row margin-bottom-10">

                        <div class="col-md-12 recent-news-inner">
                            <h3><a href="#"></a></h3>

                            <p></p>
                        </div>
                    </div>
                    <div class="row margin-bottom-10">

                        <div class="col-md-12 recent-news-inner">
                            <h3><a href="#"></a></h3>

                            <p></p>
                        </div>
                    </div>

                </div>
                <!-- END RECENT NEWS -->


                <!-- BEGIN BLOG TAGS -->
                <div class="blog-tags margin-bottom-20">
                    <h2>热门标签</h2>
                    <ul>

                    </ul>
                </div>
                <!-- END BLOG TAGS -->
            </div>
            <!-- END RIGHT SIDEBAR -->
        </div>
        <!-- END BEGIN BLOG -->
    </div>
    <!-- END CONTAINER -->

</div>
<!-- END BEGIN PAGE CONTAINER -->


<!-- BEGIN FOOTER -->
<div class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-4 col-sm-4 space-mobile">
                <!-- BEGIN ABOUT -->
                <h2>关于我</h2>

                <p class="margin-bottom-30">年近三十而不立；身为笨鸟而不先飞；知错而不悔改；空谈梦想而不行动；是也。</p>

                <div class="clearfix"></div>
                <!-- END ABOUT -->
            </div>
            <div class="col-md-4 col-sm-4 space-mobile">
                <!-- BEGIN CONTACTS -->
                <h2>联系我</h2>
                <address class="margin-bottom-40">
                    easecredit. <br/>
                    北京.朝阳 <br/>

                    QQ:909051758 <br/>
                    Email: <a href="mailto:eniluzt@qq.com">eniluzt@qq.com</a>
                </address>

            </div>
            <div class="col-md-4 col-sm-4 space-mobile">
                <!-- BEGIN CONTACTS -->
                <h2>友情链接</h2>
                <address class="margin-bottom-40">
                    网站使用metronic模版，感谢，<a target="_blank"
                                         href="http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469">go
                    to metronic</a></address>
            </div>

        </div>
    </div>
</div>
<!-- END FOOTER -->

<!-- BEGIN COPYRIGHT -->
<div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-md-8">
                <p>
                    <span class="margin-right-10">2015 © eniluzt. ALL Rights Reserved.</span>

                </p>
            </div>

        </div>
    </div>
</div>
<!-- END COPYRIGHT -->

<!-- Load javascripts at bottom, this will reduce page load time -->
<!-- BEGIN CORE PLUGINS(REQUIRED FOR ALL PAGES) -->
<!--[if lt IE 9]>
<script src="../../assets/plugins/respond.min.js"></script>
<![endif]-->
<script src="../../assets/plugins/jquery-1.10.2.min.js" type="text/javascript"></script>
<script src="../../assets/plugins/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>
<script src="../../assets/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script type="text/javascript" src="../../assets/plugins/hover-dropdown.js"></script>
<script type="text/javascript" src="../../assets/plugins/back-to-top.js"></script>
<!-- END CORE PLUGINS -->

<!-- BEGIN PAGE LEVEL JAVASCRIPTS(REQUIRED ONLY FOR CURRENT PAGE) -->
<script type="text/javascript" src="../../assets/plugins/fancybox/source/jquery.fancybox.pack.js"></script>
<script src="../../assets/scripts/app.js"></script>
<script type="text/javascript">
    jQuery(document).ready(function () {
        App.init();
    });
</script>
<script type="text/javascript" src="../../assets/scripts/blog.js"></script>
<!-- END PAGE LEVEL JAVASCRIPTS -->
</body>
<!-- END BODY -->
</html>